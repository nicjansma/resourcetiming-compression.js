!function(e){"use strict";var t,r;void 0!==e&&(t=e,r=t.ResourceTimingDecompression);var n={};n.searchSortedFirst=function(e,t,r){function n(e){return e}if(!e||0===e.length)return-1;r=r||n,t=r(t);for(var s=-1,o=e.length,i=0;s<o-1;)i=s+o>>>1,r(e[i])<t?s=i:o=i;return o},n.searchSortedLast=function(e,t,r){function n(e){return e}if(!e||0===e.length)return-1;r=r||n,t=r(t);for(var s=-1,o=e.length,i=0;s<o-1;)i=s+o>>>1,t<r(e[i])?o=i:s=i;return s},n.noConflict=function(){return t.ResourceTimingDecompression=r,n},n.INITIATOR_TYPES={other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7},n.DIMENSION_NAMES={height:0,width:1,y:2,x:3},n.getRevMap=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},n.REV_INITIATOR_TYPES=n.getRevMap(n.INITIATOR_TYPES),n.REV_DIMENSION_NAMES=n.getRevMap(n.DIMENSION_NAMES);n.decompressResources=function(e,t){var r,n=[];t=t||"";for(var s in e)if(e.hasOwnProperty(s)){var o=e[s],i=t+s;if(i.indexOf("|",i.length-1)!==-1&&(i=i.substring(0,i.length-1)),"string"==typeof o){var d=o.split("|");r=void 0,d.length>0&&this.isDimensionData(d[0])&&(r=this.decompressDimension(d[0]),d=d.splice(1));for(var u=0;u<d.length;u++){var a=d[u];a.length>0&&"*"===a[0]||n.push(this.addDimension(this.decodeCompressedResource(a,i),r))}}else{var c=this.decompressResources(o,i);n=n.concat(c)}}return n},n.isDimensionData=function(e){return e&&"*0"===e.substring(0,"*0".length)},n.decompressDimension=function(e){var t,r,n={};if(!this.isDimensionData(e))return n;if(e=e.substring("*0".length),t=e.split(","),t.length<2)return n;for(r=0;r<t.length;r++)""===t[r]?n[this.REV_DIMENSION_NAMES[r]]=0:n[this.REV_DIMENSION_NAMES[r]]=parseInt(t[r],36);return n},n.addDimension=function(e,t){if(!e||!t)return e;for(var r in this.DIMENSION_NAMES)this.DIMENSION_NAMES.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(e[r]=t[r]);return e},n.getSortedCells=function(e){for(var t=new Array(2*e.length),r=0,n=0;n<e.length;n++)t[r]={ts:e[n].startTime,val:1},r++,t[r]={ts:e[n].responseEnd,val:-1},r++;return t.sort(function(e,t){return e.ts-t.ts}),t},n.addCellContributions=function(e){for(var t=1,r=0,n=[],s=e[0].ts,o=e.length,i={},d=0;d<o;d++)i=e[d],d<o-1&&e[d+1].ts===i.ts?(e[d+1].val+=i.val,n.push(d)):d>0&&t>0&&(r=i.val,i.val=(i.ts-s)/t,s=i.ts,t+=r);for(d=n.length-1;d>=0;d--)e.splice(n[d],1);return e},n.sumContributions=function(e,t){function r(e){return e.ts}if(!t||void 0===t.startTime||void 0===t.responseEnd)return 0;for(var n=t.startTime+1,s=t.responseEnd,o=this.searchSortedFirst(e,{ts:n},r),i=this.searchSortedLast(e,{ts:s},r),d=0,u=o;u<=i;u++)d+=e[u].val;return d},n.addContribution=function(e){if(!e||0===e.length)return e;var t=this.getSortedCells(e);if(t.length<2||t[0].val<1||t[t.length-1].ts<=0)return e;this.addCellContributions(t);for(var r=t[t.length-1].ts,n=0;n<e.length;n++)e[n].contribution=this.sumContributions(t,e[n])/r;return e},n.getInitiatorTypeFromIndex=function(e){return this.REV_INITIATOR_TYPES.hasOwnProperty(e)?this.REV_INITIATOR_TYPES[e]:"other"},n.decodeCompressedResource=function(e,t){if(!e||!t)return{};t=n.reverseHostname(t);var r=parseInt(e[0],10);e=e.length>1?e.split("*1"):[];for(var s=e.length>0&&e[0].length>1?e[0].substring(1).split(","):[],o=e.length>1?e[1]:"",i=0;i<s.length;i++)""===s[i]?s[i]=0:s[i]=parseInt(s[i],36);var d=s.length>=1?s[0]:0,u=s.length<10?d:this.decodeCompressedResourceTimeStamp(s,9,d),a={name:t,initiatorType:this.getInitiatorTypeFromIndex(r),startTime:d,redirectStart:this.decodeCompressedResourceTimeStamp(s,9,d)>0?d:0,redirectEnd:this.decodeCompressedResourceTimeStamp(s,9,d),fetchStart:u,domainLookupStart:this.decodeCompressedResourceTimeStamp(s,8,d),domainLookupEnd:this.decodeCompressedResourceTimeStamp(s,7,d),connectStart:this.decodeCompressedResourceTimeStamp(s,6,d),secureConnectionStart:this.decodeCompressedResourceTimeStamp(s,5,d),connectEnd:this.decodeCompressedResourceTimeStamp(s,4,d),requestStart:this.decodeCompressedResourceTimeStamp(s,3,d),responseStart:this.decodeCompressedResourceTimeStamp(s,2,d),responseEnd:this.decodeCompressedResourceTimeStamp(s,1,d)};return a.duration=a.responseEnd>0?a.responseEnd-a.startTime:0,o.length>0&&this.decompressSize(o,a),a},n.decodeCompressedResourceTimeStamp=function(e,t,r){return e&&e.length>=t+1&&0!==e[t]?e[t]+r:0},n.decompressSize=function(e,t){var r,n;for(void 0===t&&(t={}),r=e.split(","),n=0;n<r.length;n++)"_"===r[n]?r[n]=0:(""===r[n]&&(r[n]=0),r[n]=parseInt(r[n],36),n>0&&(r[n]+=r[0]));return 1===r.length&&r.push(r[0]),2===r.length&&r.push(r[0]),t.encodedBodySize=r[0],t.transferSize=r[1],t.decodedBodySize=r[2],t},n.reverseHostname=function(e){return e.replace(/^(https?:\/\/)([^\/]+)(.*)/,function(e,t,r,s){return t+n.reverseString(r)+s})},n.reverseString=function(e){for(var t=e.length,r="";t--;)r+=e[t];return r},"function"==typeof define&&define.amd?define([],function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:void 0!==t&&(t.ResourceTimingDecompression=n)}("undefined"!=typeof window?window:void 0);