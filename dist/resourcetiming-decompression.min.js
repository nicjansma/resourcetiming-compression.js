!function(e){"use strict";var t,r;"undefined"!=typeof e&&(t=e,r=t.ResourceTimingDecompression);var n={};n.HOSTNAMES_REVERSED=!0,n.INITIATOR_TYPES={other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7,beacon:8,fetch:9,iframe:"a",subdocument:"a"},n.DIMENSION_NAMES={height:0,width:1,y:2,x:3,naturalHeight:4,naturalWidth:5},n.SCRIPT_ATTRIBUTES={scriptAsync:1,scriptDefer:2,scriptBody:4},n.REL_TYPES={prefetch:1,preload:2,prerender:3,stylesheet:4},n.getRevMap=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},n.REV_INITIATOR_TYPES=n.getRevMap(n.INITIATOR_TYPES),n.REV_DIMENSION_NAMES=n.getRevMap(n.DIMENSION_NAMES),n.REV_SCRIPT_ATTRIBUTES=n.getRevMap(n.SCRIPT_ATTRIBUTES),n.REV_REL_TYPES=n.getRevMap(n.REL_TYPES),n.SPECIAL_DATA_PREFIX="*",n.SPECIAL_DATA_DIMENSION_TYPE="0",n.SPECIAL_DATA_DIMENSION_PREFIX=n.SPECIAL_DATA_PREFIX+n.SPECIAL_DATA_DIMENSION_TYPE,n.SPECIAL_DATA_SIZE_TYPE="1",n.SPECIAL_DATA_SCRIPT_TYPE="2",n.SPECIAL_DATA_SERVERTIMING_TYPE="3",n.SPECIAL_DATA_LINK_ATTR_TYPE="4",n.SPECIAL_DATA_NAMESPACED_TYPE="5",n.HOSTNAME_REGEX=/^(https?:\/\/)([^\/]+)(.*)/,n.searchSortedFirst=function(e,t,r){function n(e){return e}if(!e||0===e.length)return-1;r=r||n,t=r(t);for(var s=-1,i=e.length,o=0;s<i-1;)o=s+i>>>1,r(e[o])<t?s=o:i=o;return i},n.searchSortedLast=function(e,t,r){function n(e){return e}if(!e||0===e.length)return-1;r=r||n,t=r(t);for(var s=-1,i=e.length,o=0;s<i-1;)o=s+i>>>1,t<r(e[o])?i=o:s=o;return s},n.noConflict=function(){return t.ResourceTimingDecompression=r,n},n.decompressResources=function(e,t,r){var s,i=[];r=r||"";for(var o in e)if(e.hasOwnProperty(o)){var a=e[o],d=r+o;if(d.indexOf("|",d.length-1)!==-1&&(d=d.substring(0,d.length-1)),"string"==typeof a){var u=a.split("|");if(0===u.length)continue;s=void 0,this.isDimensionData(u[0])&&(s=this.decompressDimension(u[0]),u=u.splice(1));for(var p=0;p<u.length;p++){var c=u[p];c.length>0&&c[0]===n.SPECIAL_DATA_PREFIX||i.push(this.addDimension(this.decodeCompressedResource(c,d,t),s))}}else{var E=this.decompressResources(a,t,d);i=i.concat(E)}}return i},n.isDimensionData=function(e){return e&&e.substring(0,n.SPECIAL_DATA_DIMENSION_PREFIX.length)===n.SPECIAL_DATA_DIMENSION_PREFIX},n.decompressDimension=function(e){var t,r,s={};if(!this.isDimensionData(e))return s;if(e=e.substring(n.SPECIAL_DATA_DIMENSION_PREFIX.length),t=e.split(","),t.length<2)return s;for(s.y=0,s.x=0,r=0;r<t.length;r++)""===t[r]?s[this.REV_DIMENSION_NAMES[r]]=0:s[this.REV_DIMENSION_NAMES[r]]=parseInt(t[r],36);return s.hasOwnProperty("naturalHeight")||(s.naturalHeight=s.height),s.hasOwnProperty("naturalWidth")||(s.naturalWidth=s.width),s},n.addDimension=function(e,t){if(!e||!t)return e;for(var r in this.DIMENSION_NAMES)this.DIMENSION_NAMES.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(e[r]=t[r]);return e},n.getSortedCells=function(e){for(var t=[],r=0;r<e.length;r++)e[r].responseEnd<=e[r].startTime||(t.push({ts:e[r].startTime,val:1}),t.push({ts:e[r].responseEnd,val:-1}));return t.sort(function(e,t){return e.ts-t.ts}),t},n.addCellContributions=function(e){for(var t=0,r=0,n=[],s=e[0].ts,i=e.length,o={},a=0;a<i;a++)o=e[a],a<i-1&&e[a+1].ts===o.ts?(e[a+1].val+=o.val,n.push(a)):(r=o.val,t>0&&(o.val=(o.ts-s)/t),s=o.ts,t+=r);for(a=n.length-1;a>=0;a--)e.splice(n[a],1);return e},n.sumContributions=function(e,t){function r(e){return e.ts}if(!t||"undefined"==typeof t.startTime||"undefined"==typeof t.responseEnd)return 0;for(var n=t.startTime+1,s=t.responseEnd,i=this.searchSortedFirst(e,{ts:n},r),o=this.searchSortedLast(e,{ts:s},r),a=0,d=i;d<=o;d++)a+=e[d].val;return a},n.addContribution=function(e){if(!e||0===e.length)return e;var t=this.getSortedCells(e);if(t.length<2||t[0].val<1||t[t.length-1].ts<=0)return e;this.addCellContributions(t);for(var r=t[t.length-1].ts,n=0;n<e.length;n++)e[n].contribution=this.sumContributions(t,e[n])/r;return e},n.getInitiatorTypeFromIndex=function(e){return this.REV_INITIATOR_TYPES.hasOwnProperty(e)?this.REV_INITIATOR_TYPES[e]:"other"},n.decodeCompressedResource=function(e,t,r){if(!e||!t)return{};n.HOSTNAMES_REVERSED&&(t=n.reverseHostname(t));var s=parseInt(e[0],10);e=e.length>1?e.split(n.SPECIAL_DATA_PREFIX):[];for(var i=e.length>0&&e[0].length>1?e[0].substring(1).split(","):[],o=e.length>1?e.slice(1):[],a=0;a<i.length;a++)""===i[a]?i[a]=0:i[a]=parseInt(i[a],36);var d=i.length>=1?i[0]:0,u=i.length<10?d:this.decodeCompressedResourceTimeStamp(i,9,d),p={name:t,initiatorType:this.getInitiatorTypeFromIndex(s),startTime:d,redirectStart:this.decodeCompressedResourceTimeStamp(i,9,d)>0?d:0,redirectEnd:this.decodeCompressedResourceTimeStamp(i,9,d),fetchStart:u,domainLookupStart:this.decodeCompressedResourceTimeStamp(i,8,d),domainLookupEnd:this.decodeCompressedResourceTimeStamp(i,7,d),connectStart:this.decodeCompressedResourceTimeStamp(i,6,d),secureConnectionStart:this.decodeCompressedResourceTimeStamp(i,5,d),connectEnd:this.decodeCompressedResourceTimeStamp(i,4,d),requestStart:this.decodeCompressedResourceTimeStamp(i,3,d),responseStart:this.decodeCompressedResourceTimeStamp(i,2,d),responseEnd:this.decodeCompressedResourceTimeStamp(i,1,d)};for(p.duration=p.responseEnd>0?p.responseEnd-p.startTime:0,a=0;a<o.length;a++)this.decompressSpecialData(o[a],p,r);return p},n.decodeCompressedResourceTimeStamp=function(e,t,r){return e&&e.length>=t+1&&0!==e[t]?e[t]+r:0},n.decompressScriptType=function(e,t){var r=parseInt(e,10);t||(t={});for(var n in this.SCRIPT_ATTRIBUTES)this.SCRIPT_ATTRIBUTES.hasOwnProperty(n)&&(t[n]=(r&this.SCRIPT_ATTRIBUTES[n])===this.SCRIPT_ATTRIBUTES[n]);return t},n.decompressLinkAttrType=function(e,t){var r=parseInt(e,10);return t||(t={}),this.REV_REL_TYPES.hasOwnProperty(r)&&(t.rel=this.REV_REL_TYPES[r]),t},n.decompressSize=function(e,t){var r,n;for("undefined"==typeof t&&(t={}),r=e.split(","),n=0;n<r.length;n++)"_"===r[n]?r[n]=0:(""===r[n]&&(r[n]=0),r[n]=parseInt(r[n],36),n>0&&(r[n]+=r[0]));return 1===r.length&&r.push(r[0]),2===r.length&&r.push(r[0]),t.encodedBodySize=r[0],t.transferSize=r[1],t.decodedBodySize=r[2],t},n.decompressNamespacedData=function(e,t){if(t=t||{},"string"==typeof e){var r=":",n=e.indexOf(r);if(n>0){var s=e.substring(0,n),i=e.substring(n+r.length);t._data=t._data||{},t._data.hasOwnProperty(s)?(Array.isArray(t._data[s])||(t._data[s]=[t._data[s]]),t._data[s].push(i)):t._data[s]=i}}return t},n.decompressSpecialData=function(e,t,r){var s;return e&&0!==e.length?(s=e[0],e=e.substring(1),s===n.SPECIAL_DATA_SIZE_TYPE?t=this.decompressSize(e,t):s===n.SPECIAL_DATA_SCRIPT_TYPE?t=this.decompressScriptType(e,t):s===n.SPECIAL_DATA_SERVERTIMING_TYPE?t=this.decompressServerTimingEntries(r,e,t):s===n.SPECIAL_DATA_LINK_ATTR_TYPE?t=this.decompressLinkAttrType(e,t):s===n.SPECIAL_DATA_NAMESPACED_TYPE&&(t=this.decompressNamespacedData(e,t)),t):t},n.reverseHostname=function(e){return e.replace(n.HOSTNAME_REGEX,function(e,t,r,s){return t+n.reverseString(r)+s})},n.reverseString=function(e){for(var t=e.length,r="";t--;)r+=e[t];return r},n.decompressServerTimingEntries=function(e,t,r){return"undefined"==typeof r&&(r={}),e&&t&&(r.serverTiming=t.split(",").map(function(t){return this.decompressServerTiming(e,t)},this)),r},n.decompressServerTiming=function(e,t){var r=t.split(":"),n=Number(r[0]),s=0,i=0;if(r.length>1){var o=r[1].split(".");""!==o[0]&&(s=Number(o[0])),o.length>1&&(i=Number(o[1]))}var a,d="";return Array.isArray(e[s])?(a=e[s][0],d=e[s][1+i]||""):a=e[s],{name:a,duration:n,description:d}},"function"==typeof define&&define.amd?define([],function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:"undefined"!=typeof t&&(t.ResourceTimingDecompression=n)}("undefined"!=typeof window?window:void 0);